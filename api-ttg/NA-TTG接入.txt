【主机服务】
vi /etc/yum.repos.d/nginx.repo
[nginx]
name=nginx repo
baseurl=http://nginx.org/packages/rhel/7/$basearch/
gpgcheck=0
enabled=1

开启SElinux支持：setsebool httpd_can_network_connect on

vi /etc/nginx/conf.d/ext.na77.org.conf
server {
    listen	80;
    ignore_invalid_headers off;
    server_name ext.na77.org 13.229.74.10;

    ## gzip setting
	gzip on;
    gzip_disable "msie6";

	gzip_vary on;
    gzip_proxied any;
    gzip_comp_level 6;
    gzip_buffers 16 8k;
    gzip_http_version 1.1;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;

    #自动构建服务
    location /deploy/ {
        proxy_pass http://localhost:3000/deploy/;
    }
    #TTG服务
    location /api/ {
        allow 27.126.228.114;	#TTG服务器
        allow 47.88.192.69;     #大厅服务器
        allow 119.4.254.86;     #测试电脑
        deny  all;
        proxy_pass http://localhost:3000/api/;
    }
}

安装：yum install nginx
启动：systemctl start nginx
停止：systemctl stop nginx
重启：systemctl restart nginx
状态：systemctl status nginx

【大厅接入】
1、玩家进入TTG游戏：
1.1、首先请求陈文接口，判断玩家是否可以进行游戏
1.2、得到陈文返回后，如果可以游戏，请求【GET】http://ext.na77.org/api/ttgtoken/:userName，其中:userName是玩家的帐号，你会得到TTG的登录TOKEN，例如以下：
<gametoken token="100099889082716542228996949651180922" uid="NA_NA01" clientAccount="NA_NA01" nickName="1180860"/>
1.3、使用token拼接游戏链接URL，打开游戏链接进入游戏
1.4、玩家进入的哪一款TTG游戏，需要记录

2、玩家退出TTG游戏：
2.1、首先请求【GET】http://ext.na77.org/api/ttglogout/:gameId/:userId/:token，其中:gameId是游戏具体ID，:userId是玩家在NA的ID，:token是玩家在TTG的TOKEN
2.2、得到接口的返回确认后，才可以关闭游戏界面

PS：游戏大厅对于TTG的断线重连，可以处理为重走1步骤